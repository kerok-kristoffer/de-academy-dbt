USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;
USE SCHEMA MYDB.MYSCHEMA;


CREATE OR REPLACE TABLE employees (
    id INTEGER,
    name VARCHAR(50),
    department VARCHAR(50),
    salary INTEGER    
);

INSERT INTO employees (id, name, department, salary)
VALUES(1, 'Pat Fay', 'HR', 50000),
(2, 'Donald O\'Connell', 'IT', 75000),
(3, 'Steven King', 'Sales', 60000),
(4, 'Susan Mavris', 'IT', 80000),
(5, 'Jennifer Whalen', 'Marketing', 55000);

SELECT * FROM employees;


// create a view
CREATE OR REPLACE VIEW it_employees AS
SELECT id, name, salary
FROM employees
WHERE department = 'IT';

SELECT * FROM it_employees;

DROP VIEW hr_employees;

CREATE OR REPLACE SECURE VIEW hr_employees AS
SELECT id, name, salary
FROM employees
WHERE department = 'HR';

SELECT * FROM hr_employees;


// materialized views caches the created table, standard views produces a new one every time from the base table.
CREATE OR REPLACE MATERIALIZED VIEW materialized_employee_salaries
AS SELECT 
    department,
    SUM(salary) AS total_salary
FROM employees
GROUP BY department;

SELECT * FROM materialized_employee_salaries;



CREATE FILE FORMAT JSON_FORMAT
TYPE = 'JSON';

SHOW FILE FORMATS;

